(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}})(function(e){var d=function(h,g){var f={pageIndex:0,pageSize:10,total:0,pageBtnCount:11,showFirstLastBtn:true,firstBtnText:null,lastBtnText:null,prevBtnText:"&laquo;",nextBtnText:"&raquo;",loadFirstPage:true,remote:{url:null,params:null,pageParams:null,success:null,beforeSend:null,complete:null,pageIndexName:"pageIndex",pageSizeName:"pageSize",totalName:"total",traditional:false},pageElementSort:["$page","$size","$jump","$info"],showInfo:false,infoFormat:"{start} ~ {end} of {total} entires",noInfoText:"0 entires",showJump:false,jumpBtnText:"Go",showPageSizes:false,pageSizeItems:[5,10,15,20],debug:false};this.$element=e(h);this.$page=e('<ul class="m-pagination-page"></ul>').hide();this.$size=e('<div class="m-pagination-size"></div>').hide();this.$jump=e('<div class="m-pagination-jump"></div>').hide();this.$info=e('<div class="m-pagination-info"></div>').hide();this.options=e.extend(true,{},f,e.fn.pagination.defaults,g);if(g.pageElementSort){this.options.pageElementSort=g.pageElementSort}else{if(e.fn.pagination.defaults&&e.fn.pagination.defaults.pageElementSort){this.options.pageElementSort=e.fn.pagination.defaults.pageElementSort}else{this.options.pageElementSort=f.pageElementSort}}this.options.pageSizeItems=g.pageSizeItems||((e.fn.pagination.defaults&&e.fn.pagination.defaults.pageSizeItems)?e.fn.pagination.defaults.pageSizeItems:f.pageSizeItems);this.total=this.options.total;this.currentUrl=this.options.remote.url;this.currentPageIndex=b.convertInt(this.options.pageIndex);this.currentPageSize=b.convertInt(this.options.pageSize);this.currentParams=b.deserializeParams(this.options.remote.params)||{};this.getLastPageNum=function(){return a.core.calLastPageNum(this.total,this.currentPageSize)};if(this.options.remote.success===null){this.options.remote.success=this.options.remote.callback}this.init()};d.prototype={getPageIndex:function(){return this.currentPageIndex},getPageSize:function(){return this.currentPageSize},getParams:function(){return this.currentParams},setPageIndex:function(f){if(f!==undefined&&f!==null){this.currentPageIndex=b.convertInt(f)}},setPageSize:function(f){if(f!==undefined&&f!==null){this.currentPageSize=b.convertInt(f)}},setRemoteUrl:function(f){if(f){this.currentUrl=f}},setParams:function(f){if(f){this.currentParams=b.deserializeParams(f)}},render:function(f){if(f!==undefined&&f!==null){this.total=b.convertInt(f)}this.renderPagination();this.debug("pagination rendered")},init:function(){this.initHtml();this.initEvent();if(this.currentUrl&&this.options.loadFirstPage){this.remote()}else{this.renderPagination()}this.debug("pagination inited")},initHtml:function(){var g=e('<select data-page-btn="size"></select>');for(var f=0;f<this.options.pageSizeItems.length;f++){g.append('<option value="'+this.options.pageSizeItems[f]+'" '+(this.currentPageSize==this.options.pageSizeItems[f]?"selected":"")+" >"+this.options.pageSizeItems[f]+"</option>")}g.val(this.currentPageSize);this.$size.append(g);var h='<div class="m-pagination-group"><input data-page-btn="jump" type="text"><button data-page-btn="jump" type="button">'+this.options.jumpBtnText+"</button></div>";this.$jump.append(h);for(var f=0;f<this.options.pageElementSort.length;f++){this.$element.append(this[this.options.pageElementSort[f]])}},initEvent:function(){this.$element.on("click",{page:this},function(f){if(e(f.target).is("button")){if(e(f.target).data("pageBtn")=="jump"){var g=f.data.page.$element.find("input[data-page-btn=jump]");f.data.page.jumpEventHandler(g.val(),f)}}else{if(e(f.target).data("pageIndex")!==undefined){c.call(f.data.page,f)}}}).on("change",{page:this},function(f){var g=e(f.target);if(g.data("pageBtn")=="jump"){f.data.page.jumpEventHandler(g.val(),f)}if(g.data("pageBtn")=="size"){c.call(f.data.page,f)}}).on("keypress",{page:this},function(f){if(f.keyCode=="13"){var g=f.data.page.$element.find("input[data-page-btn=jump]");f.data.page.jumpEventHandler(g.val(),f)}})},jumpEventHandler:function(f,g){if(!f){this.$jump.removeClass("m-pagination-error")}else{if(!a.check.checkJumpPage(f)){this.$jump.addClass("m-pagination-error")}else{if(b.convertInt(f)>this.getLastPageNum()){this.$jump.addClass("m-pagination-error")}else{this.$jump.removeClass("m-pagination-error");c.call(this,g)}}}},doPagination:function(){if(this.currentUrl){this.remote()}else{this.renderPagination()}},remote:function(){if(typeof this.options.remote.pageParams==="function"){var f=this.options.remote.pageParams.call(this,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize});this.currentParams=e.extend({},this.currentParams,f)}else{this.currentParams[this.options.remote.pageIndexName]=this.currentPageIndex;this.currentParams[this.options.remote.pageSizeName]=this.currentPageSize}a.remote.getAjax(this,this.currentUrl,this.currentParams,this.ajaxCallBack,this.options.remote.beforeSend,this.options.remote.complete,this.options.remote.traditional)},ajaxCallBack:function(f){var h=b.mapObjectNameRecursion(f,this.options.remote.totalName);if(h==null||h==undefined){throw new Error("the response of totalName :  '"+this.options.remote.totalName+"'  not found.")}h=b.convertInt(h);this.total=h;var g=this.getLastPageNum();if(this.currentPageIndex>0&&g-1<this.currentPageIndex){this.setPageIndex(g-1);this.remote()}else{if(typeof this.options.remote.success==="function"){this.options.remote.success(f)}this.renderPagination()}},onEvent:function(h,f,g){if(f!=null){this.currentPageIndex=b.convertInt(f)}if(g!=null){this.currentPageSize=b.convertInt(g)}this.doPagination();this.$element.trigger(h,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize});this.debug("pagination "+h)},renderPagination:function(){var g={showFirstLastBtn:this.options.showFirstLastBtn,firstBtnText:this.options.firstBtnText,prevBtnText:this.options.prevBtnText,nextBtnText:this.options.nextBtnText,lastBtnText:this.options.lastBtnText};var f=this.getLastPageNum();this.currentPageIndex=f>0&&this.currentPageIndex>f-1?f-1:this.currentPageIndex;this.$page.empty().append(a.core.renderPages(this.currentPageIndex,this.currentPageSize,this.total,this.options.pageBtnCount,g)).show();if(this.options.showPageSizes&&f!==0){this.$size.show()}else{this.$size.hide()}if(this.options.showJump&&f!==0){this.$jump.show()}else{this.$jump.hide()}this.$info.text(a.core.renderInfo(this.currentPageIndex,this.currentPageSize,this.total,this.options.infoFormat,this.options.noInfoText));if(this.options.showInfo){this.$info.show()}else{this.$info.hide()}},destroy:function(){this.$element.unbind().data("pagination",null).empty();this.debug("pagination destroyed")},debug:function(f,g){if(this.options.debug&&console){f&&console.info(f+" : pageIndex = "+this.currentPageIndex+" , pageSize = "+this.currentPageSize+" , total = "+this.total);g&&console.info(g)}}};var c=function(k){var j=k.data.page;var f=e(k.target);if(k.type==="click"&&f.data("pageIndex")!==undefined&&!f.parent().hasClass("active")){j.onEvent(a.event.pageClicked,f.data("pageIndex"),null)}else{if((k.type==="click"||k.type==="keypress")&&f.data("pageBtn")==="jump"){var h=j.$jump.find("input").val();if(b.convertInt(h)<=j.getLastPageNum()){j.onEvent(a.event.jumpClicked,h-1,null);j.$jump.find("input").val(null)}}else{if(k.type==="change"&&f.data("pageBtn")==="size"){var i=j.$size.find("select").val();var g=a.core.calLastPageNum(j.total,i);if(g>0&&j.currentPageIndex>g-1){j.currentPageIndex=g-1}j.onEvent(a.event.pageSizeChanged,j.currentPageIndex,i)}}}};var a={};a.event={pageClicked:"pageClicked",jumpClicked:"jumpClicked",pageSizeChanged:"pageSizeChanged"};a.remote={getAjax:function(f,g,k,l,h,j,i){e.ajax({url:g,dataType:"json",data:k,cache:false,traditional:i,contentType:"application/Json",beforeSend:function(m){if(typeof h==="function"){h.call(this,m)}},complete:function(n,m){if(typeof j==="function"){j.call(this,n,m)}},success:function(m){l.call(f,m)}})}};a.core={renderPages:function(j,o,q,g,t){t=t||{};var r=j+1;var s=this.calLastPageNum(q,o);var n=[];if(s<=g){n=this.renderGroupPages(1,s,r)}else{var k=this.renderPerPage(t.firstBtnText||1,0);var m=this.renderPerPage(t.lastBtnText||s,s-1);var i=(g-1-4)/2;if(!t.showFirstLastBtn){i=i+1}var h=(g+1)/2;var f=s-((g+1)/2);var l=this.renderPerPage(t.prevBtnText,j-1);var p=this.renderPerPage(t.nextBtnText,j+1);i=i.toString().indexOf(".")==-1?i:i+0.5;h=h.toString().indexOf(".")==-1?h:h+0.5;f=f.toString().indexOf(".")==-1?f:f+0.5;if(r<h){if(t.showFirstLastBtn){n=this.renderGroupPages(1,g-2,r);n.push(p);n.push(m)}else{n=this.renderGroupPages(1,g-1,r);n.push(p)}}else{if(r>f){if(t.showFirstLastBtn){n=this.renderGroupPages(s-g+3,g-2,r);n.unshift(l);n.unshift(k)}else{n=this.renderGroupPages(s-g+2,g-1,r);n.unshift(l)}}else{if(t.showFirstLastBtn){n=this.renderGroupPages(r-i,g-4,r);n.unshift(l);n.push(p);n.unshift(k);n.push(m)}else{n=this.renderGroupPages(r-i,g-2,r);n.unshift(l);n.push(p)}}}}return n},renderGroupPages:function(f,k,j){var h=[];for(var g=0;g<k;g++){var l=this.renderPerPage(f,f-1);if(f===j){l.addClass("active")}h.push(l);f++}return h},renderPerPage:function(g,f){return e("<li><a data-page-index='"+f+"'>"+g+"</a></li>")},renderInfo:function(l,k,h,g,f){if(h<=0){return f}else{var j=(l*k)+1;var i=(l+1)*k;i=i>=h?h:i;return g.replace("{start}",j).replace("{end}",i).replace("{total}",h)}},calLastPageNum:function(h,f){h=b.convertInt(h);f=b.convertInt(f);var g=h/f;return b.isDecimal(g)?parseInt(g)+1:g}};a.check={checkJumpPage:function(f){var g=/^\+?[1-9][0-9]*$/;return g.test(f)}};var b={convertInt:function(g){if(typeof g==="number"){return g}else{var f=parseInt(g);if(!isNaN(f)){return f}else{throw new Error("convertInt Type Error.  Type is "+typeof g+", value = "+g)}}},isDecimal:function(f){return parseInt(f)!==f},mapObjectNameRecursion:function(h,g){var k=h;var f=g.split(".");for(var j=0;j<f.length;j++){k=b.mapObjectName(k,f[j])}return k},mapObjectName:function(g,f){var j=null;for(var h in g){if(g.hasOwnProperty(h)){if(h==f){j=g[h];break}}}return j},deserializeParams:function(j){var k={};if(typeof j==="string"){var f=j.split("&");for(var h=0;h<f.length;h++){var g=f[h].split("=");k[g[0]]=decodeURIComponent(g[1])}}else{if(j instanceof Array){for(var h=0;h<j.length;h++){k[j[h].name]=decodeURIComponent(j[h].value)}}else{if(typeof j==="object"){k=j}}}return k}};e.fn.pagination=function(h){if(typeof h==="undefined"){return e(this).data("pagination")||false}else{var f;var g=arguments;this.each(function(){var l=e(this);var k=l.data("pagination");if(!k&&typeof h==="string"){throw new Error("MricodePagination is uninitialized.")}else{if(k&&typeof h==="object"){throw new Error("MricodePagination is initialized.")}else{if(!k&&typeof h==="object"){var j=typeof h=="object"&&h;var i=l.data();j=e.extend(j,i);l.data("pagination",(k=new d(this,j)))}else{if(k&&typeof h==="string"){f=k[h].apply(k,Array.prototype.slice.call(g,1))}}}}});return typeof f==="undefined"?this:f}}});
